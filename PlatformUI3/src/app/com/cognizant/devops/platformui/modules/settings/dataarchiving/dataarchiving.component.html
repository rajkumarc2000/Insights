<!--
*******************************************************************************
 * Copyright 2017 Cognizant Technology Solutions
 * 
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License.  You may obtain a copy
 * of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations under
 * the License.
 ****************************************************************************** -->

<h4 class="heading">Data Archiving settings.</h4>

<div flex="70" layout layout-align="center center" class="selectToolTxt" style="margin-top:-5px;margin-bottom:10px">
  <div *ngIf="showConfirmMessage != ''" style="text-transform: capitalize;" id="confrmMsg"> {{showConfirmMessage}}
  </div>
</div>

<div class="tableDiv" *ngIf="listView">
  <div flex="60" flex-offset="15" class="btnAlign">
    <button mat-button (click)="addData()" [disabled]="showadd">
    <mat-icon matTooltip="Add" class="mat-icon material-icons">
      add
    </mat-icon>
  </button>

    <button mat-button (click)="editData()" [disabled]="!showadd">
    <mat-icon matTooltip="Edit" class="mat-icon material-icons"> <!--usingBtnCss usingBtnCss-->
      edit
    </mat-icon>
  </button>
  </div>
  <mat-radio-group [(ngModel)]="selectedRecordg">
    <table mat-table [dataSource]="datalist" class="mat-elevation-z8">

      <ng-container matColumnDef="radio">
        <th mat-header-cell *matHeaderCellDef class="tableHeaderCss"></th>
        <td mat-cell *matCellDef="let element">
          <mat-radio-button [value]="element"></mat-radio-button>
        </td>
      </ng-container>

      <!-- Data Retention Period -->
      <ng-container matColumnDef="DataRetentionPeriod">
        <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Data Retention Period</th>
        <td mat-cell *matCellDef="let element"> {{element.backupRetentionInDays}} </td>
      </ng-container>

      <ng-container matColumnDef="MaximumNumberOfRecords">
        <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Maximum number of records for Backup File</th>
        <td mat-cell *matCellDef="let element"> {{element.rowLimit}} </td>
      </ng-container>

      <ng-container matColumnDef="Location">
        <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Location</th>
        <td mat-cell *matCellDef="let element"> {{element.backupFileLocation}} </td>
      </ng-container>

      <ng-container matColumnDef="FrequencyOfDataArchival">
        <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Frequency of Data Archival</th>
        <td mat-cell *matCellDef="let element"> {{element.dataArchivalFrequency}} </td>
      </ng-container>

      <ng-container matColumnDef="LastRuntime">
        <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Last Runtime</th>
        <td mat-cell *matCellDef="let element"> {{element.lastRunTime | date:'medium'}} </td>
      </ng-container>

      <ng-container matColumnDef="NextRuntime">
        <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">Next Runtime</th>
        <td mat-cell *matCellDef="let element"> {{element.nextRunTime | date:'medium'}} </td>
      </ng-container>

      <ng-container matColumnDef="FileFormat">
        <th mat-header-cell *matHeaderCellDef class="tableHeaderCss">File Format</th>
        <td mat-cell *matCellDef="let element"> {{element.backupFileFormat}} </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"> </tr>
    </table>
  </mat-radio-group>
</div>


<div *ngIf="saveView">
  <h4 class="heading">Customize your Data Archiving settings.</h4>
  <div class="panel panel-default">
    <form #frmdatapurging="ngForm">
      <div layout="row" layout-align="space-between start" layout-wrap layout-margin layout-padding>
        <div class="form-group">
          <label for="retention">Data Retention Period (in Days)  
          <input type="text" [(ngModel)]="retention" name="retention" class="form-control" onkeypress='return event.charCode >= 48 && event.charCode <= 57'
            ng-keypress="checkData($event,retention, 'retention')" ng-blur="checkData($event,retention, 'retention')" required
            style="width:10%;">
            </label>
        </div>
        <div class="form-group">
          <label for="rowLimitCtr">Maximum number of records for Backup File  
          <mat-select  [(ngModel)]="rowLimit" name="rowLimit" class="form-control" required placeholder="Select number of records" style="width:21%;">
            <mat-option *ngFor="let record of backupRecord" [value]="record.value">
              {{record.name}}
            </mat-option>
          </mat-select>
          </label>
        </div>
        <div class="form-group">
          <span>Backup Location  </span>
          <input [(ngModel)]="fileLocation" name="fileLocation" class="form-control" required style="width:31%;">
        </div>
      </div>
      <div layout="row" layout-align="space-between start" layout-wrap layout-margin layout-padding>

        <div class="form-group">
          <label for="dataFreqCtr">Frequency of Data Archival  </label>
          <mat-select [(ngModel)]="dataFreq" name="dataFreq" class="form-control" required placeholder="Select Frequency" style="width:21%;">
            <mat-option *ngFor="let record of dataFreqRecord" [value]="record.value">
              {{record.name}}
            </mat-option>
          </mat-select>
        </div>
        <div layout="row" layout-align="space-between start" layout-margin layout-padding class="inline-fields">
          <br>
          <div class="form-group">
            <label>Backup File Format  </label>
            <input type="text" style="width: 10%;" name="Backup File Format" class="form-control" value="JSON" readonly>
          </div>
          <div class="form-group">
            <label>Last Run Time  </label>
            <input type="text" style="width: 21%;" name="Last Run Time" class="form-control" value="{{lastRunTime}}" readonly>
          </div>
          <div class="form-group">
            <label>Next Run Time </label>
            <input type="text" style="width: 21%;" name="Next Run Time" class="form-control" value="{{nextRunTime}}" readonly>
          </div>
        </div>
      </div>
      <br>
      <div>
        <button mat-raised-button (click)="saveData()" [disabled]="frmdatapurging.invalid">
          Save
        </button>
      </div>
    </form>
  </div>
</div>